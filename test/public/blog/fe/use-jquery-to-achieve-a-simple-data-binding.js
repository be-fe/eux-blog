webpackJsonp([28,40],{922:function(n,e){n.exports={content:'<h2 id="导语"><a href="#%E5%AF%BC%E8%AF%AD" aria-hidden="true"><span class="icon icon-link"></span></a>导语</h2>\n<p>在软件开发中，MVC或者MVVM是经常被用到的设计模式。在web前端开发中，之前我们需要自己写许多代码来完成这项功能。而现在有许多优秀的类库可以帮我们实现这个功能。  </p>\n<p>许多优秀的前端框架都提供了强大的数据双向绑定的功能。比如 <strong>Ember.js</strong>， <strong>Angular.js</strong>， <strong>KnockoutJS</strong>。  </p>\n<p>如果我们在一些小型的项目中，只是希望某个功能区域有数据双向绑定的功能，是不是就非得使用这么重的框架呢？事实上，我们可以用jQuery来实现一个简单的数据双向绑定的功能。  </p>\n<p>从头开始做一个数据双向绑定并不是那么复杂。简单来说，需要实现下面三点：  </p>\n<ol start="2">\n<li>我们需要指定View中的UI元素和数据中的属性对应关系。</li>\n<li>我们需要监听View中的UI元素内容以及数据的变化。</li>\n<li>最后就是我们需要把变化通知到所有与之绑定的数据或者UI元素。</li>\n</ol>\n<h2 id="javascript-code"><a href="#javascript-code" aria-hidden="true"><span class="icon icon-link"></span></a>Javascript Code</h2>\n<pre><code data-query="{}" data-lang="">function DataBinder (objectId) {\n    // 使用jQuery空对象作为监听对象\n    var pubSub = jQuery({});\n    //\n    var dataAttr = \'bind-\' + objectId;\n    var message = objectId + \':change\';\n    // 监听dom中所有元素的 data-binding 属性变化。并由pubSub来处理。\n    $(document).on(\'input change\', \'[data-\' + dataAttr + \']\', function (event) {\n        var $ele = $(this);\n        console.log(\'$ele\', $ele);\n        pubSub.trigger(message, [$ele.data(dataAttr), $ele.val()]);\n    });\n    // pubSub把数据变化推送给所有与之绑定的页面元素\n    pubSub.on(message, function (event, proName, newValue) {\n        $(\'[data-\' + dataAttr + \'=\' + proName + \']\').each(function () {\n            var $ele = $(this);\n            if($ele.is(\'input, textarea, select\')) {\n                $ele.val(newValue);\n            } else {\n                $ele.html(newValue);\n            }\n        })\n    });\n    return pubSub;\n}\nfunction User(uid) {\n    var binder = new DataBinder(uid);\n    var user = {\n        attributes: {},\n        set: function (attrName, val) {\n            this.attributes[attrName] = val;\n            binder.trigger(uid + \':change\', [attrName, val, this]);\n        },\n        get: function (attrName) {\n            return this.attributes[attrName];\n        },\n        _binder: binder\n    }\n    return user;\n}\n</code></pre>\n<p>调用的时候，用uid与之关联。  </p>\n<h2 id="javascript-code-1"><a href="#javascript-code-1" aria-hidden="true"><span class="icon icon-link"></span></a>Javascript Code</h2>\n<pre><code data-query="{}" data-lang="">var user = new User(\'user\');\n$(\'#btnSet\').bind(\'click\', function (event) {\n    user.set(\'name\', \'Liuyuan211\');\n});\n</code></pre>\n<h2 id="html"><a href="#html" aria-hidden="true"><span class="icon icon-link"></span></a>Html</h2>\n<pre><code data-query="{}" data-lang="">&#x3C;div class="item">\n    &#x3C;label>用户名：&#x3C;/label>&#x3C;input type="text" data-bind-user="name" />&#x3C;span data-bind-user="name">&#x3C;/span>\n&#x3C;/div>\n&#x3C;div class="item">\n    &#x3C;input type="button" id="btnSet" value="Set" />\n&#x3C;/div>\n</code></pre>\n<p>该例子中，uid就是 <code>data-bind-user="name"</code> 中的 <code>user</code> ，绑定的页面元素会自动与user对应的属性关联。  </p>\n<h2 id="题外话"><a href="#%E9%A2%98%E5%A4%96%E8%AF%9D" aria-hidden="true"><span class="icon icon-link"></span></a>题外话</h2>\n<p>如果项目中需要使用的数据绑定功能更复杂，<a href="http://knockoutjs.com/documentation/observables.html">knockout.js</a> 库也是一个不错的选择。  </p>\n<ul>\n<li>免费开源</li>\n<li>javascript原生代码实现，不依赖其他库</li>\n<li>小巧，只有50多K大</li>\n<li>支持几乎所有主流浏览器</li>\n</ul>\n',extra:{}}}});